{"version":3,"sources":["../../../src/draggable.directive.ts"],"names":[],"mappings":"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","file":"draggable.directive.js","sourceRoot":"","sourcesContent":["import {\n  Directive,\n  OnInit,\n  ElementRef,\n  Renderer2,\n  Output,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  OnChanges,\n  NgZone,\n  SimpleChanges\n} from '@angular/core';\nimport {Subject} from 'rxjs/Subject';\nimport {Observable} from 'rxjs/Observable';\nimport 'rxjs/add/observable/merge';\nimport 'rxjs/add/operator/map';\nimport 'rxjs/add/operator/mergeMap';\nimport 'rxjs/add/operator/takeUntil';\nimport 'rxjs/add/operator/take';\nimport 'rxjs/add/operator/takeLast';\nimport 'rxjs/add/operator/pairwise';\nimport 'rxjs/add/operator/share';\nimport {DraggableHelper} from './draggableHelper.provider';\n\nexport type Coordinates = {x: number, y: number};\n\nexport type DragAxis = {x: boolean, y: boolean};\n\nexport type SnapGrid = {x?: number, y?: number};\n\nexport type ValidateDrag = (coordinates: Coordinates) => boolean;\n\nexport interface PointerEvent {\n  clientX: number;\n  clientY: number;\n  event: MouseEvent | TouchEvent;\n}\n\nconst MOVE_CURSOR: string = 'move';\n\n\nexport class Draggable implements OnInit, OnChanges, OnDestroy {\n\n   dropData: any;\n\n   dragAxis: DragAxis = {x: true, y: true};\n\n   dragSnapGrid: SnapGrid = {};\n\n   ghostDragEnabled: boolean = true;\n\n   validateDrag: ValidateDrag;\n\n   dragStart: EventEmitter<Coordinates> = new EventEmitter<Coordinates>();\n\n   dragging: EventEmitter<Coordinates> = new EventEmitter<Coordinates>();\n\n   dragEnd: EventEmitter<Coordinates> = new EventEmitter<Coordinates>();\n\n  /**\n   * @hidden\n   */\n  pointerDown: Subject<PointerEvent> = new Subject();\n\n  /**\n   * @hidden\n   */\n  pointerMove: Subject<PointerEvent> = new Subject();\n\n  /**\n   * @hidden\n   */\n  pointerUp: Subject<PointerEvent> = new Subject();\n\n  private eventListenerSubscriptions: {\n    mousemove?: Function,\n    mousedown?: Function,\n    mouseup?: Function,\n    mouseenter?: Function,\n    mouseleave?: Function,\n    touchstart?: Function,\n    touchmove?: Function,\n    touchend?: Function,\n    touchcancel?: Function\n  } = {};\n\n  /**\n   * @hidden\n   */\n  constructor(\n    public element: ElementRef,\n    private renderer: Renderer2,\n    private draggableHelper: DraggableHelper,\n    private zone: NgZone\n  ) {}\n\n  ngOnInit(): void {\n\n    this.checkEventListeners();\n\n    const pointerDrag: Observable<any> = this.pointerDown\n      .filter(() => this.canDrag())\n      .flatMap((pointerDownEvent: PointerEvent) => {\n\n        this.zone.run(() => {\n          this.dragStart.next({x: 0, y: 0});\n        });\n\n        this.setCursor(MOVE_CURSOR);\n\n        const currentDrag: Subject<any> = new Subject();\n\n        this.draggableHelper.currentDrag.next(currentDrag);\n\n        const pointerMove: Observable<Coordinates> = this.pointerMove\n          .map((pointerMoveEvent: PointerEvent) => {\n\n            pointerMoveEvent.event.preventDefault();\n\n            return {\n              currentDrag,\n              x: pointerMoveEvent.clientX - pointerDownEvent.clientX,\n              y: pointerMoveEvent.clientY - pointerDownEvent.clientY,\n              clientX: pointerMoveEvent.clientX,\n              clientY: pointerMoveEvent.clientY\n            };\n\n          })\n          .map((moveData: Coordinates) => {\n\n            if (this.dragSnapGrid.x) {\n              moveData.x = Math.floor(moveData.x / this.dragSnapGrid.x) * this.dragSnapGrid.x;\n            }\n\n            if (this.dragSnapGrid.y) {\n              moveData.y = Math.floor(moveData.y / this.dragSnapGrid.y) * this.dragSnapGrid.y;\n            }\n\n            return moveData;\n          })\n          .map((moveData: Coordinates) => {\n\n            if (!this.dragAxis.x) {\n              moveData.x = 0;\n            }\n\n            if (!this.dragAxis.y) {\n              moveData.y = 0;\n            }\n\n            return moveData;\n          })\n          .filter(({x, y}) => !this.validateDrag || this.validateDrag({x, y}))\n          .takeUntil(Observable.merge(this.pointerUp, this.pointerDown));\n\n        pointerMove.takeLast(1).subscribe(({x, y}) => {\n          this.zone.run(() => {\n            this.dragEnd.next({x, y});\n          });\n          currentDrag.complete();\n          this.setCssTransform(null);\n          if (this.ghostDragEnabled) {\n            this.renderer.setStyle(this.element.nativeElement, 'pointerEvents', null);\n          }\n        });\n\n        return pointerMove;\n\n      })\n      .share();\n\n    Observable\n      .merge(\n        pointerDrag.take(1).map(value => [, value]),\n        pointerDrag.pairwise()\n      )\n      .filter(([previous, next]) => {\n        if (!previous) {\n          return true;\n        }\n        return previous.x !== next.x || previous.y !== next.y;\n      })\n      .map(([previous, next]) => next)\n      .subscribe(({x, y, currentDrag, clientX, clientY}) => {\n        this.zone.run(() => {\n          this.dragging.next({x, y});\n        });\n        if (this.ghostDragEnabled) {\n          this.renderer.setStyle(this.element.nativeElement, 'pointerEvents', 'none');\n        }\n        this.setCssTransform(`translate(${x}px, ${y}px)`);\n        currentDrag.next({\n          clientX,\n          clientY,\n          dropData: this.dropData\n        });\n      });\n\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['dragAxis']) {\n      this.checkEventListeners();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.unsubscribeEventListeners();\n    this.pointerDown.complete();\n    this.pointerMove.complete();\n    this.pointerUp.complete();\n  }\n\n  private checkEventListeners(): void {\n\n    const canDrag: boolean = this.canDrag();\n    const hasEventListeners: boolean = Object.keys(this.eventListenerSubscriptions).length > 0;\n\n    if (canDrag && !hasEventListeners) {\n\n      this.zone.runOutsideAngular(() => {\n\n        this.eventListenerSubscriptions.mousedown = this.renderer.listen(this.element.nativeElement, 'mousedown', (event: MouseEvent) => {\n          this.onMouseDown(event);\n        });\n\n        this.eventListenerSubscriptions.mouseup = this.renderer.listen('document', 'mouseup', (event: MouseEvent) => {\n          this.onMouseUp(event);\n        });\n\n        this.eventListenerSubscriptions.touchstart = this.renderer.listen(this.element.nativeElement, 'touchstart', (event: TouchEvent) => {\n          this.onTouchStart(event);\n        });\n\n        this.eventListenerSubscriptions.touchend = this.renderer.listen('document', 'touchend', (event: TouchEvent) => {\n          this.onTouchEnd(event);\n        });\n\n        this.eventListenerSubscriptions.touchcancel = this.renderer.listen('document', 'touchcancel', (event: TouchEvent) => {\n          this.onTouchEnd(event);\n        });\n\n        this.eventListenerSubscriptions.mouseenter = this.renderer.listen(this.element.nativeElement, 'mouseenter', () => {\n          this.onMouseEnter();\n        });\n\n        this.eventListenerSubscriptions.mouseleave = this.renderer.listen(this.element.nativeElement, 'mouseleave', () => {\n          this.onMouseLeave();\n        });\n\n      });\n\n    } else if (!canDrag && hasEventListeners) {\n      this.unsubscribeEventListeners();\n    }\n\n  }\n\n  private onMouseDown(event: MouseEvent): void {\n    if (!this.eventListenerSubscriptions.mousemove) {\n      this.eventListenerSubscriptions.mousemove = this.renderer.listen('document', 'mousemove', (event: MouseEvent) => {\n        this.pointerMove.next({event, clientX: event.clientX, clientY: event.clientY});\n      });\n    }\n    this.pointerDown.next({event, clientX: event.clientX, clientY: event.clientY});\n  }\n\n  private onMouseUp(event: MouseEvent): void {\n    if (this.eventListenerSubscriptions.mousemove) {\n      this.eventListenerSubscriptions.mousemove();\n      delete this.eventListenerSubscriptions.mousemove;\n    }\n    this.pointerUp.next({event, clientX: event.clientX, clientY: event.clientY});\n  }\n\n  private onTouchStart(event: TouchEvent): void {\n    if (!this.eventListenerSubscriptions.touchmove) {\n      this.eventListenerSubscriptions.touchmove = this.renderer.listen('document', 'touchmove', (event: TouchEvent) => {\n        this.pointerMove.next({event, clientX: event.targetTouches[0].clientX, clientY: event.targetTouches[0].clientY});\n      });\n    }\n    this.pointerDown.next({event, clientX: event.touches[0].clientX, clientY: event.touches[0].clientY});\n  }\n\n  private onTouchEnd(event: TouchEvent): void {\n    if (this.eventListenerSubscriptions.touchmove) {\n      this.eventListenerSubscriptions.touchmove();\n      delete this.eventListenerSubscriptions.touchmove;\n    }\n    this.pointerUp.next({event, clientX: event.changedTouches[0].clientX, clientY: event.changedTouches[0].clientY});\n  }\n\n  private onMouseEnter(): void {\n    this.setCursor(MOVE_CURSOR);\n  }\n\n  private onMouseLeave(): void {\n    this.setCursor(null);\n  }\n\n  private setCssTransform(value: string): void {\n    if (this.ghostDragEnabled) {\n      this.renderer.setStyle(this.element.nativeElement, 'transform', value);\n      this.renderer.setStyle(this.element.nativeElement, '-webkit-transform', value);\n      this.renderer.setStyle(this.element.nativeElement, '-ms-transform', value);\n      this.renderer.setStyle(this.element.nativeElement, '-moz-transform', value);\n      this.renderer.setStyle(this.element.nativeElement, '-o-transform', value);\n    }\n  }\n\n  private canDrag(): boolean {\n    return this.dragAxis.x || this.dragAxis.y;\n  }\n\n  private setCursor(value: string): void {\n    this.renderer.setStyle(this.element.nativeElement, 'cursor', value);\n  }\n\n  private unsubscribeEventListeners(): void {\n    Object.keys(this.eventListenerSubscriptions).forEach((type: string) => {\n      this.eventListenerSubscriptions[type]();\n      delete this.eventListenerSubscriptions[type];\n    });\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[mwlDraggable]'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: Renderer2, },\n{type: DraggableHelper, },\n{type: NgZone, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'dropData': [{ type: Input },],\n'dragAxis': [{ type: Input },],\n'dragSnapGrid': [{ type: Input },],\n'ghostDragEnabled': [{ type: Input },],\n'validateDrag': [{ type: Input },],\n'dragStart': [{ type: Output },],\n'dragging': [{ type: Output },],\n'dragEnd': [{ type: Output },],\n};\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}